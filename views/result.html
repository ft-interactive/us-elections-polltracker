{% extends "g-ui/layout/article" %}

{% import "page-elements.html" as PageElements -%}

{% set layout = {name: 'full-body'} %}
{% set stylesheets = [
  'https://origami-build.ft.com/v2/bundles/css?modules=o-expander@^4.0.2,o-buttons@^4.0.2,o-grid@^4.2.1,o-cookie-message@^2.2.0',
  'g-ui/main.css',
  'main.css',
  'result-page.css',
  'result-bars.css'
  ]
%}
{% set scripts = [
  'result-page.js',
  'g-ui/index.js',
  'https://origami-build.ft.com/v2/bundles/js?export=bundle&modules=o-expander@^4.0.2,o-buttons@^4.0.2,o-date@^2.6.0,o-cookie-message@^2.2.0'
  ]
%}

{% block appendhead %}
<script>
var pageDataTimestamp = {{ overview.timestamp }};
</script>
{% endblock -%}

{% block article_body %}
<div class="article__main">
  <div class="o-grid-container">
    <div class="o-grid-row">
      <div data-o-grid-colspan="center 12">
          {% import "includes/result-bar-macros.html" as bars %}
          <div>
            <div class="o-grid-row result-bars president-bars">
              {{ bars.president(
                  overview.president.isFinal,
                  overview.president.clinton,
                  overview.president.clinton_pct,
                  overview.president.trump,
                  overview.president.trump_pct,
                  overview.president.bestGuessClinton_pct,
                  overview.president.bestGuessTrump_pct,
                  "footnote") }}
            </div>
              <div>
                  {% include "includes/results-plain-map.svg" %}
              </div>
              <div>
                  {% include "includes/results-dot-map.svg" %}
              </div>
          </div>
      </div>

      <div data-o-grid-colspan="center 12">
        <div class="o-ads o-ads--center o-ads--reserve-90 o-ads--transition"
          data-o-ads-name="mid"
          data-o-ads-center="true"
          data-o-ads-targeting="pos=mid"
          data-o-ads-formats-default="MediumRectangle,Responsive"
          data-o-ads-formats-small="MediumRectangle,Responsive"
          data-o-ads-formats-medium="Leaderboard"
          data-o-ads-formats-large="SuperLeaderboard,Leaderboard"
          data-o-ads-formats-extra="SuperLeaderboard,Leaderboard"
          data-o-ads-lazy-load="true"
          aria-hidden="true">
        </div>
      </div>

      <div data-o-grid-colspan="12 L6">
          {% call PageElements.Figure(title="What the US media is saying") %}
            {% for org in mediaOrgs %}
            <div>{{ org.name }} Clinton:{{org.totals.d}} Trump:{{org.totals.r}} ({{ org.totals.r + org.totals.d }}/ 538)</div>
            {% endfor %}
          {% endcall %}
      </div>
      <div data-o-grid-colspan="12 L6">
          <div class="house-bars">
            {% call PageElements.Figure(title="House", id="House") %}
                  {{ bars.house(
                    overview.house.dem_pct,
                    overview.house.dem,
                    overview.house.rep_pct,
                    overview.house.rep,
                    "footnote") }}
            {% endcall %}
          </div>
          <div class="senate-bars">
            {% call PageElements.Figure(title="Senate", id="Senate") %}
              {{ bars.senate(
                overview.senate.dem_pct,
                overview.senate.dem,
                overview.senate.rep_pct,
                overview.senate.rep,
                "footnote")
              }}
            {% endcall %}
          </div>
      </div>

      {% set showSuggestedReads = flags.onwardJourney and
                                  flags.resultSuggestedReads and
                                  onwardJourney.suggestedReads.data and
                                  onwardJourney.suggestedReads.data.items and
                                  onwardJourney.suggestedReads.data.items.length > 2 %}
      {% if showSuggestedReads %}
        </div>
      </div>
      <div class="o-grid-container o-grid-container--bleed">
        <div class="o-grid-row">
          <aside data-o-grid-colspan="center 12">
          {% set firstThreeSelectedReads = onwardJourney.suggestedReads.data.items.slice(0, 3) %}
          {{ PageElements.SuggestedReads(title="Top stories", items=firstThreeSelectedReads) }}
          </aside>
        </div>
      </div>
      <div class="o-grid-container">
        <div class="o-grid-row">
      {% endif %}

      <div data-o-grid-colspan="center 12 M9 L6">
          {% call PageElements.Figure(title="All states", id="all-states") %}
            <table class="ecresultslist">
              <thead>
                <tr>
                  <th class="ecresultslist__headercell">2012</th>
                  <th class="ecresultslist__headercell">2016</th>
                  <th class="ecresultslist__headercell">State</th>
                  <th class="ecresultslist__headercell">Votes</th>
                  <th class="ecresultslist__headercell--optional">Margin</th>
                </tr>
              </thead>
              <tbody>
                {% for state in stateResults %}
                <tr class="ecresultslist__row" id="{{ state.code }}-row">
                  <td class="ecresultslist__cell--{{ state.code | winner2012 }}"></td>
                  <td class="ecresultslist__cell--{% if state.winner == 'r' %}rep{% endif %}{% if state.winner == 'd' %}dem{% endif %}">{% if state.winner == 'r' %} Trump {% endif %} {% if state.winner == 'd' %}Clinton{% endif %}</td>
                  <td class="ecresultslist__cell">{{ state.code | stateName }}</td>
                  <td class="ecresultslist__cell">{{ state.ecvotes }}</td>
                  <td class="ecresultslist__cell"></td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          {% endcall %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
